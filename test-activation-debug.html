<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Extension Activation Debug Test</title>
    <style>
        body {
            font-family: Arial, sans-serif;
            max-width: 800px;
            margin: 0 auto;
            padding: 20px;
            background: #f5f5f5;
        }
        .test-box {
            background: white;
            padding: 20px;
            margin: 10px 0;
            border-radius: 8px;
            border: 1px solid #ddd;
        }
        .success { border-left: 4px solid #4CAF50; }
        .error { border-left: 4px solid #f44336; }
        .warning { border-left: 4px solid #ff9800; }
        button {
            background: #007bff;
            color: white;
            border: none;
            padding: 10px 20px;
            border-radius: 4px;
            cursor: pointer;
            margin: 5px;
        }
        button:hover { background: #0056b3; }
        pre { background: #f8f9fa; padding: 10px; border-radius: 4px; overflow-x: auto; }
        .master-keys { font-family: monospace; font-size: 12px; }
    </style>
</head>
<body>
    <h1>🔧 Extension Activation Debug Tool</h1>
    
    <div class="test-box">
        <h3>📋 Master Keys Testing</h3>
        <p>Test these working master keys with your extension:</p>
        <div class="master-keys">
            <div>• OCUS-PRO-7X9K-2M8L-QW3R-UNLIMITED-2025</div>
            <div>• JOBHUNTER-ENTERPRISE-5N4B-8F7G-H1J2-PREMIUM-KEY</div>
            <div>• UNLIMITED-ACCESS-9P0L-3K5M-6V8C-MASTER-2025</div>
            <div>• PREMIUM-EXTENSION-4R7T-2Y9U-1I8O-ENTERPRISE-CODE</div>
            <div>• MASTER-ACTIVATION-8Q5W-6E3R-9T7Y-UNLIMITED-ACCESS</div>
        </div>
        <button onclick="copyKey('OCUS-PRO-7X9K-2M8L-QW3R-UNLIMITED-2025')">Copy First Key</button>
    </div>

    <div class="test-box">
        <h3>🔗 Server Connection Test</h3>
        <button onclick="testServerConnection()">Test Backend Connection</button>
        <div id="serverResult"></div>
    </div>

    <div class="test-box">
        <h3>📝 Extension Installation Steps</h3>
        <ol>
            <li>Download the v2.3.0-VISUAL-PREMIUM-UI.zip from your user dashboard</li>
            <li>Extract the ZIP file to a folder</li>
            <li>Open Chrome and go to <code>chrome://extensions/</code></li>
            <li>Enable "Developer mode" (toggle in top right)</li>
            <li>Click "Load unpacked" and select the extracted folder</li>
            <li>The extension icon should appear in Chrome toolbar</li>
            <li>Click the icon to open popup</li>
            <li>Paste a master key and click "🚀 Activate Extension"</li>
        </ol>
    </div>

    <div class="test-box">
        <h3>🐛 Troubleshooting Checklist</h3>
        <div id="troubleshoot">
            <div>❓ Extension popup opens when you click the icon?</div>
            <div>❓ You can see the activation input field?</div>
            <div>❓ Master key gets accepted (no error message)?</div>
            <div>❓ Success notification appears?</div>
            <div>❓ UI transforms to green premium theme?</div>
            <div>❓ Alert popup confirms premium activation?</div>
        </div>
    </div>

    <div class="test-box warning">
        <h3>🔍 Console Debug Messages to Look For</h3>
        <p>Open the extension popup, then right-click → Inspect → Console tab</p>
        <ul>
            <li>🚀 POPUP.JS: DOMContentLoaded fired</li>
            <li>🔧 DEBUG ACTIVATION LOADED</li>
            <li>🔍 Activation button found: [object]</li>
            <li>🎯 ACTIVATION BUTTON CLICKED!</li>
            <li>🔥🔥🔥 ACTIVATION FUNCTION CALLED! 🔥🔥🔥</li>
            <li>=== ACTIVATION DEBUG START ===</li>
            <li>✅ MASTER KEY DETECTED!</li>
            <li>🎯 TRANSFORMING UI TO PREMIUM MODE</li>
        </ul>
        <p>If you don't see these messages, the activation isn't triggering properly.</p>
    </div>

    <div class="test-box">
        <h3>📊 Expected Visual Changes After Activation</h3>
        <ul>
            <li>✅ Header shows "💎 PREMIUM ACTIVATED" with green gradient</li>
            <li>✅ Activation section becomes premium status card</li>
            <li>✅ Background changes to premium gradient theme</li>
            <li>✅ Extension title gets premium badge</li>
            <li>✅ Trial elements completely hidden</li>
            <li>✅ Success alert with feature list</li>
        </ul>
    </div>

    <script>
        function copyKey(key) {
            navigator.clipboard.writeText(key).then(() => {
                alert('Master key copied! Paste it in your extension activation field.');
            });
        }

        async function testServerConnection() {
            const resultDiv = document.getElementById('serverResult');
            resultDiv.innerHTML = '<div>🔍 Testing connection...</div>';
            
            try {
                const response = await fetch('/api/activate', {
                    method: 'POST',
                    headers: {
                        'Content-Type': 'application/json'
                    },
                    body: JSON.stringify({ 
                        activation_key: 'TEST-CONNECTION-KEY' 
                    })
                });
                
                const data = await response.json();
                
                if (response.ok) {
                    resultDiv.innerHTML = `
                        <div class="success">
                            ✅ Server connection successful!<br>
                            Response: ${JSON.stringify(data, null, 2)}
                        </div>
                    `;
                } else {
                    resultDiv.innerHTML = `
                        <div class="warning">
                            ⚠️ Server responded but key invalid (expected)<br>
                            Status: ${response.status}<br>
                            Response: ${JSON.stringify(data, null, 2)}
                        </div>
                    `;
                }
            } catch (error) {
                resultDiv.innerHTML = `
                    <div class="error">
                        ❌ Server connection failed<br>
                        Error: ${error.message}<br>
                        Check if server is running and CORS is configured
                    </div>
                `;
            }
        }
    </script>
</body>
</html>