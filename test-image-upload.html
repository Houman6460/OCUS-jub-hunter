<!DOCTYPE html>
<html>
<head>
    <title>Test Image Upload</title>
    <style>
        body { font-family: Arial, sans-serif; margin: 20px; }
        .result { margin: 20px 0; padding: 10px; background: #f5f5f5; border-radius: 5px; }
        img { max-width: 300px; margin: 10px 0; }
        input, button { margin: 10px 0; padding: 10px; }
    </style>
</head>
<body>
    <h1>Test SEO Settings Image Upload</h1>
    
    <form id="uploadForm">
        <div>
            <label>Site Title:</label><br>
            <input type="text" name="siteTitle" value="Test Upload" style="width: 300px;">
        </div>
        
        <div>
            <label>Custom OG Image:</label><br>
            <input type="file" name="customOgImage" accept="image/*">
        </div>
        
        <button type="submit">Upload</button>
    </form>
    
    <div id="result" class="result" style="display: none;"></div>
    
    <h2>Current Settings</h2>
    <div id="current" class="result">Loading...</div>

    <script>
        // Load current settings
        async function loadCurrent() {
            try {
                const response = await fetch('/api/admin/seo-settings');
                const data = await response.json();
                document.getElementById('current').innerHTML = `
                    <pre>${JSON.stringify(data, null, 2)}</pre>
                    ${data.customOgImage ? `<br><img src="${data.customOgImage}" alt="Current OG Image">` : ''}
                `;
            } catch (error) {
                document.getElementById('current').innerHTML = 'Error: ' + error.message;
            }
        }

        // Handle form submission
        document.getElementById('uploadForm').addEventListener('submit', async (e) => {
            e.preventDefault();
            
            const formData = new FormData(e.target);
            const resultDiv = document.getElementById('result');
            
            try {
                resultDiv.style.display = 'block';
                resultDiv.innerHTML = 'Uploading...';
                
                const response = await fetch('/api/admin/seo-settings', {
                    method: 'PUT',
                    body: formData
                });
                
                if (response.ok) {
                    const result = await response.json();
                    resultDiv.innerHTML = `
                        <h3>Success!</h3>
                        <pre>${JSON.stringify(result, null, 2)}</pre>
                        ${result.customOgImage ? `<br><img src="${result.customOgImage}" alt="Uploaded Image">` : ''}
                    `;
                    // Reload current settings
                    setTimeout(loadCurrent, 1000);
                } else {
                    const error = await response.text();
                    resultDiv.innerHTML = `<h3>Error!</h3><pre>${error}</pre>`;
                }
            } catch (error) {
                resultDiv.innerHTML = `<h3>Error!</h3><pre>${error.message}</pre>`;
            }
        });

        // Load current settings on page load
        loadCurrent();
    </script>
</body>
</html>